<!doctype html>
<!--
    Tangram: real-time WebGL rendering for OpenStreetMap

    http://github.com/tangrams/tangram
    http://mapzen.com
-->
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.0-beta.2/leaflet.css" />

    <style>
        body {
            margin: 0px;
            border: 0px;
            padding: 0px;
        }

        #map {
            height: 100%;
            width: 100%;
            position: absolute;
        }

    </style>
  </head>

  <body>
    <div id="map"></div>

    <!-- leaflet -->
    <script src="lib/leaflet.js"></script>

    <!-- Demo setup -->
    <script>
        var map, layer, scene;
        function loadMap() {
            map = L.map('map', {
                keyboardZoomOffset : 1.,
                attributionControl: false,
                zoomControl: false
            });
            map.setView([0,0],1);

            layer = Tangram.leafletLayer({
                scene: 'empty.yaml'
            });
            layer.addTo(map);

            scene = layer.scene;
            // console.log('map loaded')
        }
    </script>

    <!-- Main tangram library -->
    <script id="tangram" onload="loadMap()"></script>

    <!-- Load Tangram by URL -->
    <script>

        function getQueryVariable(variable) {
           var query = window.location.search.substring(1);
           var vars = query.split("&");
           for (var i=0;i<vars.length;i++) {
                   var pair = vars[i].split("=");
                   if(pair[0] == variable){return pair[1];}
           }
           return(false);
        }

        var url = getQueryVariable("url");
        var scriptElement = document.getElementById("tangram");
        if (url == "") {
            lib_url = "https://mapzen.com/tangram/tangram.debug.js";
        } else if (url.indexOf("/") > -1) {
            // assume it's a full path
            // check that it's a tangram library
            if (url.substr(url.length - 17) == '/tangram.debug.js' ||
                url.substr(url.length - 15) == '/tangram.min.js') {
                var lib_url = url;
            } else {
                // noooo you don't
                console.log('lib param error:', url, "is not a valid tangram library, defaulting to latest release");
                lib_url = 'https://mapzen.com/tangram/tangram.debug.js';
            }
        } else if (url.indexOf("/") == -1) {
            // assume it's a version # only
            lib_url = "https://mapzen.com/tangram/"+url+"/tangram.debug.js";
        }

        scriptElement.src = lib_url;

    </script>

  </body>
</html>
